"use strict";exports.id=648,exports.ids=[648],exports.modules={13661:(e,t,s)=>{s.d(t,{Z:()=>l});let l=(0,s(62881).Z)("Delete",[["path",{d:"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z",key:"1oy587"}],["line",{x1:"18",x2:"12",y1:"9",y2:"15",key:"1olkx5"}],["line",{x1:"12",x2:"18",y1:"9",y2:"15",key:"1n50pc"}]])},42887:(e,t,s)=>{s.d(t,{Z:()=>l});let l=(0,s(62881).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},94004:(e,t,s)=>{s.d(t,{P:()=>y});var l=s(10326),a=s(17577),i=s(60962),n=s(46226),r=s(91664),d=s(29752),c=s(44794),o=s(18069),m=s(84097),x=s(53566),h=s(74603),u=s(94019),g=s(77506),f=s(41291),j=s(50732),N=s(941),p=s(32933),b=s(13661);let v=e=>{if(!e)return null;let t=x.Cy.find(t=>t.id===e.toLowerCase());return t?.avatar||null},w=[{digit:"1",letters:""},{digit:"2",letters:"ABC"},{digit:"3",letters:"DEF"},{digit:"4",letters:"GHI"},{digit:"5",letters:"JKL"},{digit:"6",letters:"MNO"},{digit:"7",letters:"PQRS"},{digit:"8",letters:"TUV"},{digit:"9",letters:"WXYZ"},{digit:"*",letters:""},{digit:"0",letters:"+"},{digit:"#",letters:""}];function y({agentId:e,agentName:t,callWindow:s,onClose:x,onCallInitiated:y}){let{toast:k}=(0,m.pm)(),[C,Z]=(0,a.useState)([]),[S,$]=(0,a.useState)(!e),[D,_]=(0,a.useState)(!1),[O,F]=(0,a.useState)(e?{id:e,name:t||"Agent",callWindowStart:s?.start,callWindowEnd:s?.end}:null),[M,A]=(0,a.useState)(""),[P,E]=(0,a.useState)(!1),[L,W]=(0,a.useState)(!1),z=O?{start:O.callWindowStart,end:O.callWindowEnd}:void 0,H=e=>e.length<=3?e:e.length<=6?`(${e.slice(0,3)}) ${e.slice(3)}`:e.length<=10?`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6)}`:`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6,10)}`,I=e=>{let t=M.replace(/\D/g,"");t.length<10&&A(H(t+e))},V=()=>{if(!z?.start||!z?.end)return!0;let e=new Date,t=`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`;return t>=z.start&&t<=z.end},Y=async()=>{if(!O){k({title:"Select an agent",description:"Please select an agent to make the call",variant:"destructive"});return}let e=M.replace(/\D/g,"");if(e.length<10){k({title:"Invalid phone number",description:"Please enter a valid 10-digit phone number",variant:"destructive"});return}if(!V()){k({title:"Outside call window",description:`Calls can only be made between ${z?.start} and ${z?.end}`,variant:"destructive"});return}E(!0);try{let t=`+1${e}`,s=await o.h.makeOutboundCall(O.id,t);k({title:"\uD83D\uDCF1 Dialing...",description:`Calling ${M}`}),y&&y(s.data),x()}catch(e){k({title:"Error",description:e instanceof o.M?e.message:"Failed to initiate call",variant:"destructive"})}finally{E(!1)}},q=M.replace(/\D/g,"");if(!L)return null;let B=l.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 flex items-center justify-center p-4",children:(0,l.jsxs)(d.Zb,{className:"w-full max-w-sm max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)(d.Ol,{className:"pb-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[l.jsx(h.Z,{className:"h-5 w-5 text-slate-600"}),l.jsx(d.ll,{className:"text-slate-600",children:"Make Call"})]}),l.jsx("button",{onClick:x,className:"text-muted-foreground hover:text-slate-600 transition-colors",children:l.jsx(u.Z,{className:"h-5 w-5"})})]}),(0,l.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Place a call ",O&&(0,l.jsxs)(l.Fragment,{children:["using ",l.jsx("span",{className:"font-medium text-slate-600",children:O.name})]})]})]}),(0,l.jsxs)(d.aY,{className:"space-y-4",children:[!e&&(0,l.jsxs)("div",{className:"space-y-2",children:[l.jsx(c._,{className:"text-muted-foreground",children:"Agent"}),S?(0,l.jsxs)("div",{className:"flex items-center gap-2 p-3 border rounded-md",children:[l.jsx(g.Z,{className:"h-4 w-4 animate-spin text-teal-600"}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading agents..."})]}):0===C.length?l.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md",children:(0,l.jsxs)("div",{className:"flex items-start gap-2",children:[l.jsx(f.Z,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),(0,l.jsxs)("div",{className:"text-sm text-amber-700",children:[l.jsx("p",{className:"font-medium",children:"No voice agents"}),l.jsx("p",{className:"mt-0.5 text-xs",children:"Create an agent with Voice or Omnichannel channel."})]})]})}):(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>_(!D),className:"w-full flex items-center gap-3 p-3 border rounded-md bg-white hover:bg-slate-50 transition-colors",children:[O?(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:v(O.voice)?l.jsx(n.default,{src:v(O.voice),alt:O.name,width:32,height:32,className:"w-full h-full object-cover"}):l.jsx(j.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[l.jsx("p",{className:"font-medium text-slate-600 truncate text-sm",children:O.name}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"OMNICHANNEL"===O.communicationChannel?"Omnichannel":"Voice"})]})]}):(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:l.jsx(j.Z,{className:"h-4 w-4 text-muted-foreground"})}),l.jsx("span",{className:"text-sm text-muted-foreground",children:"Select an agent..."})]}),l.jsx(N.Z,{className:`h-4 w-4 text-muted-foreground ml-auto transition-transform ${D?"rotate-180":""}`})]}),D&&l.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border rounded-md shadow-lg max-h-48 overflow-y-auto",children:C.map(e=>{let t=v(e.voice),s=O?.id===e.id;return(0,l.jsxs)("button",{type:"button",onClick:()=>{F(e),_(!1)},className:`w-full flex items-center gap-3 p-3 hover:bg-slate-50 transition-colors ${s?"bg-teal-50":""}`,children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:t?l.jsx(n.default,{src:t,alt:e.name,width:32,height:32,className:"w-full h-full object-cover"}):l.jsx(j.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,l.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[l.jsx("p",{className:"font-medium text-slate-600 truncate text-sm",children:e.name}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"OMNICHANNEL"===e.communicationChannel?"Omnichannel":"Voice"})]}),s&&l.jsx(p.Z,{className:"h-4 w-4 text-teal-600 flex-shrink-0"})]},e.id)})})]})]}),(0,l.jsxs)("div",{className:"relative py-4",children:[l.jsx("div",{className:"h-10 flex items-center justify-center",children:M?l.jsx("span",{className:"text-2xl font-semibold text-slate-700 tracking-wide",children:M}):l.jsx("span",{className:"text-2xl text-slate-300",children:"(___) ___-____"})}),M&&l.jsx("button",{type:"button",onClick:()=>{A(H(M.replace(/\D/g,"").slice(0,-1)))},className:"absolute right-0 top-1/2 -translate-y-1/2 p-2 text-slate-400 hover:text-slate-600 transition-colors",disabled:P||!e&&!O,children:l.jsx(b.Z,{className:"h-6 w-6"})})]}),l.jsx("div",{className:"grid grid-cols-3 gap-3",children:w.map(t=>(0,l.jsxs)("button",{type:"button",onClick:()=>I(t.digit),className:"flex flex-col items-center justify-center h-16 rounded-full bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:P||!e&&!O,children:[l.jsx("span",{className:"text-xl font-semibold text-slate-700",children:t.digit}),t.letters&&l.jsx("span",{className:"text-[10px] text-slate-400 tracking-widest",children:t.letters})]},t.digit))}),z?.start&&z?.end&&!V()&&l.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,l.jsxs)("p",{className:"text-sm text-amber-700",children:["⚠️ Outside call window (",z.start," - ",z.end,")"]})}),(0,l.jsxs)("div",{className:"flex gap-3 pt-2",children:[l.jsx(r.z,{type:"button",variant:"outline",onClick:x,className:"flex-1 text-slate-600",disabled:P,children:"Cancel"}),l.jsx(r.z,{type:"button",onClick:Y,className:"flex-1 bg-teal-600 hover:bg-teal-700",disabled:P||!O||q.length<10,children:P?(0,l.jsxs)(l.Fragment,{children:[l.jsx(g.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Calling..."]}):(0,l.jsxs)(l.Fragment,{children:[l.jsx(h.Z,{className:"h-4 w-4 mr-2"}),"Call Now"]})})]})]})]})});return(0,i.createPortal)(B,document.body)}}};