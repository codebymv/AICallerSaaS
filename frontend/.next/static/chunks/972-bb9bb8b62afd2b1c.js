"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[972],{50768:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(79205).Z)("Delete",[["path",{d:"M20 5H9l-7 7 7 7h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2Z",key:"1oy587"}],["line",{x1:"18",x2:"12",y1:"9",y2:"15",key:"1olkx5"}],["line",{x1:"12",x2:"18",y1:"9",y2:"15",key:"1n50pc"}]])},51817:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(79205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},12194:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(79205).Z)("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]])},99397:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(79205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},32489:function(e,t,l){l.d(t,{Z:function(){return a}});let a=(0,l(79205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},21688:function(e,t,l){l.d(t,{P:function(){return k}});var a=l(57437),s=l(2265),n=l(54887),i=l(33145),c=l(12381),r=l(79820),d=l(75060),o=l(71837),m=l(23340),u=l(78705),x=l(12194),h=l(32489),f=l(51817),g=l(49322),p=l(82222),N=l(40875),j=l(30401),b=l(50768);let v=e=>{if(!e)return null;let t=u.Cy.find(t=>t.id===e.toLowerCase());return(null==t?void 0:t.avatar)||null},w=e=>"VOICE_ONLY"===e||"OMNICHANNEL"===e||!e,y=[{digit:"1",letters:""},{digit:"2",letters:"ABC"},{digit:"3",letters:"DEF"},{digit:"4",letters:"GHI"},{digit:"5",letters:"JKL"},{digit:"6",letters:"MNO"},{digit:"7",letters:"PQRS"},{digit:"8",letters:"TUV"},{digit:"9",letters:"WXYZ"},{digit:"*",letters:""},{digit:"0",letters:"+"},{digit:"#",letters:""}];function k(e){let{agentId:t,agentName:l,callWindow:u,onClose:k,onCallInitiated:C}=e,{toast:Z}=(0,m.pm)(),[S,_]=(0,s.useState)([]),[M,O]=(0,s.useState)(!t),[E,D]=(0,s.useState)(!1),[A,F]=(0,s.useState)(t?{id:t,name:l||"Agent",callWindowStart:null==u?void 0:u.start,callWindowEnd:null==u?void 0:u.end}:null),[L,P]=(0,s.useState)(""),[z,I]=(0,s.useState)(!1),[H,V]=(0,s.useState)(!1),W=A?{start:A.callWindowStart,end:A.callWindowEnd}:void 0;(0,s.useEffect)(()=>{V(!0)},[]),(0,s.useEffect)(()=>{t||Y()},[t]);let Y=async()=>{O(!0);try{let e=((await o.h.getAgents()).data||[]).filter(e=>w(e.communicationChannel));_(e)}catch(e){console.error("Failed to fetch agents:",e)}finally{O(!1)}},X=e=>e.length<=3?e:e.length<=6?"(".concat(e.slice(0,3),") ").concat(e.slice(3)):e.length<=10?"(".concat(e.slice(0,3),") ").concat(e.slice(3,6),"-").concat(e.slice(6)):"(".concat(e.slice(0,3),") ").concat(e.slice(3,6),"-").concat(e.slice(6,10)),q=e=>{let t=L.replace(/\D/g,"");t.length<10&&P(X(t+e))},B=()=>{if(!(null==W?void 0:W.start)||!(null==W?void 0:W.end))return!0;let e=new Date,t="".concat(e.getHours().toString().padStart(2,"0"),":").concat(e.getMinutes().toString().padStart(2,"0"));return t>=W.start&&t<=W.end},G=async()=>{if(!A){Z({title:"Select an agent",description:"Please select an agent to make the call",variant:"destructive"});return}let e=L.replace(/\D/g,"");if(e.length<10){Z({title:"Invalid phone number",description:"Please enter a valid 10-digit phone number",variant:"destructive"});return}if(!B()){Z({title:"Outside call window",description:"Calls can only be made between ".concat(null==W?void 0:W.start," and ").concat(null==W?void 0:W.end),variant:"destructive"});return}I(!0);try{let t=await o.h.makeOutboundCall(A.id,"+1".concat(e));Z({title:"\uD83D\uDCF1 Dialing...",description:"Calling ".concat(L)}),C&&C(t.data),k()}catch(e){Z({title:"Error",description:e instanceof o.M?e.message:"Failed to initiate call",variant:"destructive"})}finally{I(!1)}},J=L.replace(/\D/g,"");if(!H)return null;let K=(0,a.jsx)("div",{className:"fixed inset-0 z-[100] bg-black/50 flex items-center justify-center p-4",children:(0,a.jsxs)(r.Zb,{className:"w-full max-w-sm max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(r.Ol,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 text-slate-600"}),(0,a.jsx)(r.ll,{className:"text-slate-600",children:"Make Call"})]}),(0,a.jsx)("button",{onClick:k,className:"text-muted-foreground hover:text-slate-600 transition-colors",children:(0,a.jsx)(h.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Place a call ",A&&(0,a.jsxs)(a.Fragment,{children:["using ",(0,a.jsx)("span",{className:"font-medium text-slate-600",children:A.name})]})]})]}),(0,a.jsxs)(r.aY,{className:"space-y-4",children:[!t&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d._,{className:"text-muted-foreground",children:"Agent"}),M?(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 border rounded-md",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 animate-spin text-teal-600"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading agents..."})]}):0===S.length?(0,a.jsx)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"text-sm text-amber-700",children:[(0,a.jsx)("p",{className:"font-medium",children:"No voice agents"}),(0,a.jsx)("p",{className:"mt-0.5 text-xs",children:"Create an agent with Voice or Omnichannel channel."})]})]})}):(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>D(!E),className:"w-full flex items-center gap-3 p-3 border rounded-md bg-white hover:bg-slate-50 transition-colors",children:[A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:v(A.voice)?(0,a.jsx)(i.default,{src:v(A.voice),alt:A.name,width:32,height:32,className:"w-full h-full object-cover"}):(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-slate-600 truncate text-sm",children:A.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"OMNICHANNEL"===A.communicationChannel?"Omnichannel":"Voice"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Select an agent..."})]}),(0,a.jsx)(N.Z,{className:"h-4 w-4 text-muted-foreground ml-auto transition-transform ".concat(E?"rotate-180":"")})]}),E&&(0,a.jsx)("div",{className:"absolute z-10 mt-1 w-full bg-white border rounded-md shadow-lg max-h-48 overflow-y-auto",children:S.map(e=>{let t=v(e.voice),l=(null==A?void 0:A.id)===e.id;return(0,a.jsxs)("button",{type:"button",onClick:()=>{F(e),D(!1)},className:"w-full flex items-center gap-3 p-3 hover:bg-slate-50 transition-colors ".concat(l?"bg-teal-50":""),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:t?(0,a.jsx)(i.default,{src:t,alt:e.name,width:32,height:32,className:"w-full h-full object-cover"}):(0,a.jsx)(p.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-slate-600 truncate text-sm",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"OMNICHANNEL"===e.communicationChannel?"Omnichannel":"Voice"})]}),l&&(0,a.jsx)(j.Z,{className:"h-4 w-4 text-teal-600 flex-shrink-0"})]},e.id)})})]})]}),(0,a.jsxs)("div",{className:"relative py-4",children:[(0,a.jsx)("div",{className:"h-10 flex items-center justify-center",children:L?(0,a.jsx)("span",{className:"text-2xl font-semibold text-slate-700 tracking-wide",children:L}):(0,a.jsx)("span",{className:"text-2xl text-slate-300",children:"(___) ___-____"})}),L&&(0,a.jsx)("button",{type:"button",onClick:()=>{P(X(L.replace(/\D/g,"").slice(0,-1)))},className:"absolute right-0 top-1/2 -translate-y-1/2 p-2 text-slate-400 hover:text-slate-600 transition-colors",disabled:z||!t&&!A,children:(0,a.jsx)(b.Z,{className:"h-6 w-6"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:y.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>q(e.digit),className:"flex flex-col items-center justify-center h-16 rounded-full bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:z||!t&&!A,children:[(0,a.jsx)("span",{className:"text-xl font-semibold text-slate-700",children:e.digit}),e.letters&&(0,a.jsx)("span",{className:"text-[10px] text-slate-400 tracking-widest",children:e.letters})]},e.digit))}),(null==W?void 0:W.start)&&(null==W?void 0:W.end)&&!B()&&(0,a.jsx)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-amber-700",children:["⚠️ Outside call window (",W.start," - ",W.end,")"]})}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)(c.z,{type:"button",variant:"outline",onClick:k,className:"flex-1 text-slate-600",disabled:z,children:"Cancel"}),(0,a.jsx)(c.z,{type:"button",onClick:G,className:"flex-1 bg-teal-600 hover:bg-teal-700",disabled:z||!A||J.length<10,children:z?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Calling..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Call Now"]})})]})]})]})});return(0,n.createPortal)(K,document.body)}}}]);