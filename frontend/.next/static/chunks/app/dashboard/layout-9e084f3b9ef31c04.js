(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{30692:function(e,t,l){Promise.resolve().then(l.bind(l,32899))},32899:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return k}});var s=l(57437),a=l(2265),n=l(33145),o=l(27648),r=l(99376),i=l(25466),c=l(82222),d=l(10306),h=l(95805),u=l(41217),m=l(12194),x=l(53417),f=l(51817),g=l(32489),p=l(58293),b=l(98728),v=l(47692),j=l(12381),N=l(71837),w=l(72423),C=l(23340);let y=[{href:"/dashboard",label:"Dashboard",icon:i.Z},{href:"/dashboard/agents",label:"Agents",icon:c.Z},{href:"/dashboard/voices",label:"Voices",icon:d.Z},{href:"/dashboard/contacts",label:"Contacts",icon:h.Z},{href:"/dashboard/dialpad",label:"Dialpad",icon:u.Z},{href:"/dashboard/calls",label:"Call Logs",icon:m.Z},{href:"/dashboard/messaging",label:"Messaging",icon:x.Z}];function k(e){var t,l;let{children:i}=e,c=(0,r.useRouter)(),d=(0,r.usePathname)(),[h,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[k,E]=(0,a.useState)(!1);return(!function(e){let{toast:t}=(0,C.pm)(),l=(0,a.useRef)(null),s=(0,a.useRef)(!1),n=(0,a.useCallback)(e=>{console.log("[CallEvents] Call started:",e),t({title:"\uD83D\uDCDE Call Connected",description:"Agent is now on the line"})},[t]),o=(0,a.useCallback)(e=>{console.log("[CallEvents] Call ended:",e),t({title:"\uD83D\uDCF4 Call Ended",description:"The call has been completed"})},[t]);(0,a.useEffect)(()=>{var t;if(!e||s.current&&(null===(t=l.current)||void 0===t?void 0:t.connected))return;console.log("[CallEvents] Connecting to Socket.IO server...");let a=(0,w.io)("http://localhost:3001",{transports:["websocket","polling"],autoConnect:!0});return l.current=a,a.on("connect",()=>{console.log("[CallEvents] Connected to server"),s.current=!0,a.emit("subscribe_dashboard",{userId:e})}),a.on("disconnect",()=>{console.log("[CallEvents] Disconnected from server"),s.current=!1}),a.on("connect_error",e=>{console.error("[CallEvents] Connection error:",e)}),a.on("call_started",n),a.on("call_ended",o),a.on("active_calls",e=>{console.log("[CallEvents] Active calls:",e.length)}),()=>{console.log("[CallEvents] Cleaning up socket connection"),a.off("call_started",n),a.off("call_ended",o),a.disconnect(),s.current=!1}},[e,n,o]),l.current}((null==h?void 0:h.id)||null),(0,a.useEffect)(()=>{(async()=>{try{let e=await N.h.getMe();u(e.data)}catch(e){c.push("/login")}finally{x(!1)}})()},[c]),m)?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)(f.Z,{className:"h-8 w-8 animate-spin text-teal-600"})}):(0,s.jsxs)("div",{className:"bg-slate-50",children:[(0,s.jsxs)("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-white border-b px-4 py-3 flex items-center justify-between",children:[(0,s.jsx)(j.z,{variant:"ghost",size:"icon",onClick:()=>E(!k),className:"-ml-2",children:k?(0,s.jsx)(g.Z,{className:"h-5 w-5"}):(0,s.jsx)(p.Z,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{className:"flex items-center gap-3 absolute left-1/2 transform -translate-x-1/2",children:[(0,s.jsx)(n.default,{src:"/gleam-logo-icon.png",alt:"Gleam",width:28,height:28,priority:!0,className:"h-7 w-7"}),(0,s.jsx)(n.default,{src:"/gleam-logo-text.png",alt:"Gleam",width:80,height:24,priority:!0,className:"h-6 w-auto"})]})]}),(0,s.jsx)("aside",{className:"fixed top-[60px] lg:top-0 bottom-0 left-0 z-40 w-64 bg-slate-50/90 backdrop-blur-xl border-r transform transition-transform duration-200 ease-in-out lg:translate-x-0 ".concat(k?"translate-x-0":"-translate-x-full"),children:(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 px-6 py-5 bg-gradient-to-b from-[#0fa693] to-teal-600",children:[(0,s.jsx)(n.default,{src:"/logo-icon-transparent-inverted.png",alt:"Gleam Icon",width:32,height:32,priority:!0,className:"h-8 w-8"}),(0,s.jsx)(n.default,{src:"/gleam-logo-text-inverted.png",alt:"Gleam",width:100,height:32,priority:!0,className:"h-7 w-auto"})]}),(0,s.jsx)("nav",{className:"flex-1 px-4 py-4 space-y-1",children:y.map(e=>{let t=e.icon,l="/dashboard"===e.href?"/dashboard"===d:d.startsWith(e.href);return(0,s.jsxs)(o.default,{href:e.href,className:"group flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat(l?"bg-gradient-to-b from-[#0fa693] to-teal-600 text-white":"text-slate-600 hover:bg-slate-100"),onClick:()=>E(!1),children:[(0,s.jsx)(t,{className:"h-5 w-5 transition-colors ".concat(l?"":"group-hover:text-teal-600")}),e.label]},e.href)})}),(0,s.jsx)("div",{className:"px-4 pb-4",children:(0,s.jsxs)(o.default,{href:"/dashboard/settings",className:"group flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat(d.startsWith("/dashboard/settings")?"bg-gradient-to-b from-[#0fa693] to-teal-600 text-white":"text-slate-600 hover:bg-slate-100"),onClick:()=>E(!1),children:[(0,s.jsx)(b.Z,{className:"h-5 w-5 transition-colors ".concat(d.startsWith("/dashboard/settings")?"":"group-hover:text-teal-600")}),"Settings"]})}),(0,s.jsxs)("div",{className:"p-4 bg-teal-600",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 px-3 py-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-white/20 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-white",children:(null==h?void 0:null===(t=h.name)||void 0===t?void 0:t.charAt(0))||(null==h?void 0:null===(l=h.email)||void 0===l?void 0:l.charAt(0))||"U"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-white truncate",children:(null==h?void 0:h.name)||"User"}),(0,s.jsx)("p",{className:"text-xs text-white truncate",children:null==h?void 0:h.email})]})]}),(0,s.jsxs)(j.z,{variant:"ghost",className:"w-full justify-start mt-2 text-white/80 hover:bg-white/10 hover:text-white",onClick:()=>{N.h.logout(),c.push("/login")},children:[(0,s.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Log out"]})]})]})}),(0,s.jsxs)("main",{className:"lg:pl-64 relative min-h-screen",children:[(0,s.jsxs)("div",{className:"fixed inset-0 pointer-events-none overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-50 via-teal-50/20 to-slate-100/50"}),(0,s.jsx)("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-gradient-to-bl from-teal-100/30 to-transparent rounded-full blur-3xl"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-gradient-to-tr from-slate-200/30 to-transparent rounded-full blur-3xl"}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/3 w-[300px] h-[300px] bg-gradient-to-r from-teal-50/40 to-transparent rounded-full blur-3xl"})]}),(0,s.jsx)("div",{className:"relative p-4 sm:p-6 pt-20 lg:pt-6",children:i})]}),k&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-30 lg:hidden",onClick:()=>E(!1)})]})}}},function(e){e.O(0,[225,145,648,599,92,971,117,744],function(){return e(e.s=30692)}),_N_E=e.O()}]);