(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{6679:function(e,t,s){Promise.resolve().then(s.bind(s,4213))},4213:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return F}});var a=s(7437),l=s(2265),n=s(9376),i=s(7648),r=s(3145),d=s(2381),c=s(9820),o=s(279),m=s(1837),x=s(3340),u=s(8705),h=s(9173),f=s(4887),g=s(2194),p=s(2489),j=s(768),N=s(1817);let b=[{digit:"1",letters:""},{digit:"2",letters:"ABC"},{digit:"3",letters:"DEF"},{digit:"4",letters:"GHI"},{digit:"5",letters:"JKL"},{digit:"6",letters:"MNO"},{digit:"7",letters:"PQRS"},{digit:"8",letters:"TUV"},{digit:"9",letters:"WXYZ"},{digit:"*",letters:""},{digit:"0",letters:"+"},{digit:"#",letters:""}];function v(e){let{agentId:t,agentName:s,callWindow:n,onClose:i,onCallInitiated:r}=e,{toast:o}=(0,x.pm)(),[u,h]=(0,l.useState)(""),[v,w]=(0,l.useState)(!1),[y,k]=(0,l.useState)(!1);(0,l.useEffect)(()=>{k(!0)},[]);let S=e=>e.length<=3?e:e.length<=6?"(".concat(e.slice(0,3),") ").concat(e.slice(3)):e.length<=10?"(".concat(e.slice(0,3),") ").concat(e.slice(3,6),"-").concat(e.slice(6)):"(".concat(e.slice(0,3),") ").concat(e.slice(3,6),"-").concat(e.slice(6,10)),C=e=>{let t=u.replace(/\D/g,"");t.length<10&&h(S(t+e))},O=()=>{if(!(null==n?void 0:n.start)||!(null==n?void 0:n.end))return!0;let e=new Date,t="".concat(e.getHours().toString().padStart(2,"0"),":").concat(e.getMinutes().toString().padStart(2,"0"));return t>=n.start&&t<=n.end},Z=async()=>{let e=u.replace(/\D/g,"");if(e.length<10){o({title:"Invalid phone number",description:"Please enter a valid 10-digit phone number",variant:"destructive"});return}if(!O()){o({title:"Outside call window",description:"Calls can only be made between ".concat(null==n?void 0:n.start," and ").concat(null==n?void 0:n.end),variant:"destructive"});return}w(!0);try{let s=await m.h.makeOutboundCall(t,"+1".concat(e));o({title:"Call initiated!",description:"Calling ".concat(u,"...")}),r&&r(s.data),i()}catch(e){o({title:"Error",description:e instanceof m.M?e.message:"Failed to initiate call",variant:"destructive"})}finally{w(!1)}},T=u.replace(/\D/g,"");if(!y)return null;let A=(0,a.jsx)("div",{className:"fixed inset-0 z-[100] bg-black/50 flex items-center justify-center p-4",children:(0,a.jsxs)(c.Zb,{className:"w-full max-w-sm",children:[(0,a.jsxs)(c.Ol,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-slate-600"}),(0,a.jsx)(c.ll,{className:"text-slate-600",children:"Make Outbound Call"})]}),(0,a.jsx)("button",{onClick:i,className:"text-muted-foreground hover:text-slate-600 transition-colors",children:(0,a.jsx)(p.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Place a call using ",(0,a.jsx)("span",{className:"font-medium text-slate-600",children:s})]})]}),(0,a.jsxs)(c.aY,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("div",{className:"h-10 flex items-center justify-center",children:u?(0,a.jsx)("span",{className:"text-2xl font-semibold text-slate-700 tracking-wide",children:u}):(0,a.jsx)("span",{className:"text-2xl text-slate-300",children:"(___) ___-____"})})}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:b.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>C(e.digit),className:"flex flex-col items-center justify-center h-16 rounded-full bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition-colors",disabled:v,children:[(0,a.jsx)("span",{className:"text-xl font-semibold text-slate-700",children:e.digit}),e.letters&&(0,a.jsx)("span",{className:"text-[10px] text-slate-400 tracking-widest",children:e.letters})]},e.digit))}),(0,a.jsx)("div",{className:"flex justify-end px-4",children:(0,a.jsx)("button",{type:"button",onClick:()=>{h(S(u.replace(/\D/g,"").slice(0,-1)))},className:"p-2 text-slate-400 hover:text-slate-600 transition-colors",disabled:!u||v,children:(0,a.jsx)(j.Z,{className:"h-6 w-6"})})}),(null==n?void 0:n.start)&&(null==n?void 0:n.end)&&!O()&&(0,a.jsx)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-amber-700",children:["⚠️ Outside call window (",n.start," - ",n.end,")"]})}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)(d.z,{type:"button",variant:"outline",onClick:i,className:"flex-1 text-slate-600",disabled:v,children:"Cancel"}),(0,a.jsx)(d.z,{type:"button",onClick:Z,className:"flex-1 bg-teal-600 hover:bg-teal-700",disabled:v||T.length<10,children:v?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Calling..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Call Now"]})})]})]})]})});return(0,f.createPortal)(A,document.body)}var w=s(1866),y=s(7580),k=s(8428),S=s(2660),C=s(2222),O=s(3041),Z=s(8420),T=s(9322),A=s(8728),D=s(875),E=s(1047),I=s(2369);let P=e=>{let t=e.replace(/\D/g,"");return 11===t.length&&t.startsWith("1")?"(".concat(t.slice(1,4),") ").concat(t.slice(4,7),"-").concat(t.slice(7)):e},_=e=>{switch(e){case"INBOUND":return(0,a.jsx)(w.Z,{className:"h-4 w-4 text-teal-600"});case"OUTBOUND":return(0,a.jsx)(y.Z,{className:"h-4 w-4 text-teal-600"});case"HYBRID":return(0,a.jsx)(k.Z,{className:"h-4 w-4 text-teal-600"});default:return null}};function F(){var e,t,s,f,g,p,j,N;let b=(0,n.useParams)(),w=(0,n.useRouter)(),y=(0,n.useSearchParams)(),{toast:k}=(0,x.pm)(),[F,z]=(0,l.useState)(null),[M,B]=(0,l.useState)(!0),[U,W]=(0,l.useState)(!1),[G,R]=(0,l.useState)("true"===y.get("edit")),[H,L]=(0,l.useState)(!1),[Y,V]=(0,l.useState)(""),[X,$]=(0,l.useState)(""),[q,J]=(0,l.useState)(""),[K,Q]=(0,l.useState)(""),[ee,et]=(0,l.useState)("INBOUND"),[es,ea]=(0,l.useState)(""),[el,en]=(0,l.useState)(""),[ei,er]=(0,l.useState)(""),[ed,ec]=(0,l.useState)(!1),[eo,em]=(0,l.useState)(null),[ex,eu]=(0,l.useState)(""),[eh,ef]=(0,l.useState)(null),[eg,ep]=(0,l.useState)([]),[ej,eN]=(0,l.useState)(null),[eb,ev]=(0,l.useState)(""),[ew,ey]=(0,l.useState)(!0),[ek,eS]=(0,l.useState)(!1),[eC,eO]=(0,l.useState)(!1),[eZ,eT]=(0,l.useState)(!1),eA=(0,l.useRef)(null);(0,l.useEffect)(()=>{e_(),eE(),eI(),eD()},[b.id]);let eD=async()=>{try{let e=await m.h.getBusinessProfile();ef(e.data||null)}catch(e){}};(0,l.useEffect)(()=>{let e=e=>{eA.current&&!eA.current.contains(e.target)&&eO(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let eE=async()=>{try{let e=await m.h.getCalendarStatus();em(e.data||null)}catch(e){console.error("Failed to fetch calendar status:",e)}},eI=async()=>{ey(!0);try{var e,t;let s=await m.h.getTwilioSettings();if(eS((null===(e=s.data)||void 0===e?void 0:e.configured)||!1),null===(t=s.data)||void 0===t?void 0:t.configured){let e=(await m.h.getPhoneNumbers()).data||[];ep(e);let t=e.find(e=>{var t;return(null===(t=e.agent)||void 0===t?void 0:t.id)===b.id});eN(t||null),ev((null==t?void 0:t.id)||"")}}catch(e){}finally{ey(!1)}},eP=async e=>{eT(!0),eO(!1);try{ej&&ej.id!==e&&await m.h.updatePhoneNumber(ej.id,{agentId:null}),e&&await m.h.updatePhoneNumber(e,{agentId:b.id}),ev(e),await eI(),k({title:e?"Phone number assigned":"Phone number unassigned",description:e?"The phone number has been assigned to this agent.":"The phone number has been removed from this agent."})}catch(e){k({title:"Error",description:e instanceof m.M?e.message:"Failed to update phone number",variant:"destructive"}),ev((null==ej?void 0:ej.id)||"")}finally{eT(!1)}},e_=async()=>{try{let e=await m.h.getAgent(b.id);e.data&&(z(e.data),V(e.data.name),$(e.data.systemPrompt),J(e.data.greeting||""),Q(e.data.voice||u.Cy[0].id),et(e.data.mode||"INBOUND"),ea(e.data.outboundGreeting||""),en(e.data.callWindowStart||""),er(e.data.callWindowEnd||""),ec(e.data.calendarEnabled||!1),eu(e.data.callPurpose||""))}catch(e){k({title:"Error",description:e instanceof m.M?e.message:"Failed to load agent",variant:"destructive"}),w.push("/dashboard/agents")}finally{B(!1)}},eF=async()=>{W(!0);try{var e;await m.h.updateAgent(b.id,{name:Y,systemPrompt:X,greeting:q,voiceId:K,mode:ee,outboundGreeting:es||void 0,callWindowStart:el||void 0,callWindowEnd:ei||void 0,calendarEnabled:ed,personaName:(null===(e=u.Cy.find(e=>e.id===K))||void 0===e?void 0:e.name)||void 0,callPurpose:ex||void 0}),k({title:"Agent updated",description:"Your changes have been saved."}),R(!1),e_()}catch(e){k({title:"Error",description:e instanceof m.M?e.message:"Failed to update agent",variant:"destructive"})}finally{W(!1)}},ez=async()=>{if(confirm("Are you sure you want to delete this agent?"))try{await m.h.deleteAgent(b.id),k({title:"Agent deleted",description:"The agent has been removed."}),w.push("/dashboard/agents")}catch(e){k({title:"Error",description:e instanceof m.M?e.message:"Failed to delete agent",variant:"destructive"})}};return M?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)("div",{className:"text-muted-foreground",children:"Loading agent..."})}):F?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 min-w-0",children:[(0,a.jsx)(i.default,{href:"/dashboard/agents",className:"flex-shrink-0",children:(0,a.jsxs)(d.z,{variant:"ghost",size:"sm",className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Back"]})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(C.Z,{className:"h-6 w-6 text-slate-600 flex-shrink-0"}),(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-slate-600 truncate max-w-[200px] sm:max-w-[250px]",title:F.name,children:F.name})]}),(0,a.jsxs)("p",{className:"text-muted-foreground text-xs",children:[(null===(e=u.jt[F.mode])||void 0===e?void 0:e.label)||F.mode," agent"]})]})]}),(0,a.jsxs)("div",{className:"hidden lg:flex items-stretch gap-3 flex-1 mx-6",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-center px-4 py-2 bg-white rounded-lg border flex-1",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Total Calls"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-slate-600",children:F.totalCalls||"—"})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-center px-4 py-2 bg-white rounded-lg border flex-1",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Avg Duration"}),(0,a.jsx)("span",{className:"text-lg font-semibold text-slate-600",children:F.avgDuration?"".concat(Math.round(F.avgDuration),"s"):"—"})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-center px-4 py-2 bg-white rounded-lg border flex-1",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Status"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-0.5",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(F.isActive?"bg-green-100 text-green-700":"bg-slate-100 text-slate-600"),children:F.isActive?"Active":"Inactive"}),F.mode&&u.jt[F.mode]&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,a.jsx)("span",{className:"w-4 h-4 rounded-full flex items-center justify-center bg-teal-100",children:_(F.mode)}),u.jt[F.mode].label]})]})]})]}),(0,a.jsx)("div",{className:"flex gap-2 flex-shrink-0",children:G?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.z,{variant:"outline",onClick:()=>R(!1),className:"text-teal-600 border-teal-600 hover:bg-teal-50",children:"Cancel"}),(0,a.jsx)(d.z,{onClick:eF,disabled:U,className:"bg-teal-600 hover:bg-teal-700",children:U?"Saving...":"Save Changes"})]}):(0,a.jsxs)(a.Fragment,{children:[("OUTBOUND"===F.mode||"HYBRID"===F.mode)&&(0,a.jsxs)(d.z,{onClick:()=>L(!0),className:"bg-teal-600 hover:bg-teal-700",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Make Call"]}),(0,a.jsx)(d.z,{variant:"outline",onClick:()=>R(!0),className:"text-teal-600 border-teal-600 hover:bg-teal-50",children:"Edit"}),(0,a.jsx)(d.z,{variant:"destructive",onClick:ez,children:"Delete"})]})})]}),(0,a.jsxs)("div",{className:"grid gap-4 grid-cols-3 lg:hidden",children:[(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.Ol,{className:"p-3",children:[(0,a.jsx)(c.SZ,{className:"text-xs",children:"Total Calls"}),(0,a.jsx)(c.ll,{className:"text-xl text-slate-600",children:F.totalCalls||"—"})]})}),(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.Ol,{className:"p-3",children:[(0,a.jsx)(c.SZ,{className:"text-xs",children:"Avg Duration"}),(0,a.jsx)(c.ll,{className:"text-xl text-slate-600",children:F.avgDuration?"".concat(Math.round(F.avgDuration),"s"):"—"})]})}),(0,a.jsx)(c.Zb,{children:(0,a.jsxs)(c.Ol,{className:"p-3",children:[(0,a.jsx)(c.SZ,{className:"text-xs",children:"Status"}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-1",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(F.isActive?"bg-green-100 text-green-700":"bg-slate-100 text-slate-600"),children:F.isActive?"Active":"Inactive"})})]})})]})]}),(0,a.jsxs)(c.Zb,{children:[(0,a.jsxs)(c.Ol,{children:[(0,a.jsx)(c.ll,{className:"text-slate-600",children:"Agent Configuration"}),(0,a.jsx)(c.SZ,{children:"Voice and AI model settings"})]}),(0,a.jsx)(c.aY,{className:"space-y-6",children:G?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"name",className:"text-sm font-medium text-muted-foreground",children:"Agent Name"}),(0,a.jsx)(o.I,{id:"name",value:Y,onChange:e=>V(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Organization"}),(null==eh?void 0:eh.organizationName)?(0,a.jsx)("div",{className:"p-4 border rounded-lg border-teal-500 bg-teal-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center bg-teal-100",children:(0,a.jsx)(Z.Z,{className:"h-3 w-3 text-teal-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-sm text-muted-foreground",children:eh.organizationName})]})}):(0,a.jsx)(i.default,{href:"/dashboard/settings?tab=preferences",className:"block",children:(0,a.jsxs)("div",{className:"p-4 border rounded-lg border-amber-300 bg-amber-50 hover:border-amber-400 transition-colors cursor-pointer",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center bg-amber-100",children:(0,a.jsx)(T.Z,{className:"h-3 w-3 text-amber-600"})}),(0,a.jsx)("h3",{className:"font-semibold text-sm text-amber-800",children:"Not configured"})]}),(0,a.jsx)("p",{className:"text-xs text-amber-700",children:"Click to set up your organization profile in Settings"})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone Number"}),ew?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading phone numbers..."}):ek?0===eg.length?(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-slate-100 border border-slate-200 rounded-md",children:[(0,a.jsx)(O.Z,{className:"h-4 w-4 text-slate-500 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-slate-700",children:"No phone numbers available"}),(0,a.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:"Import phone numbers from your Twilio account to assign to this agent."}),(0,a.jsxs)(i.default,{href:"/dashboard/settings",className:"inline-flex items-center gap-1 mt-2 text-xs text-teal-600 hover:underline",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3"}),"Manage Phone Numbers"]})]})]}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"relative",ref:eA,children:[(0,a.jsxs)("button",{type:"button",onClick:()=>eO(!eC),disabled:eZ,className:"flex items-center gap-3 px-3 py-2.5 text-sm border rounded-md w-full justify-between transition-colors disabled:opacity-50 ".concat(eb?"border-teal-500 bg-teal-50":"bg-white hover:bg-slate-50"),children:[(0,a.jsx)("div",{className:"flex items-center gap-2.5 min-w-0",children:eb?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(O.Z,{className:"h-4 w-4 text-teal-600"})}),(0,a.jsx)("span",{className:"font-medium text-slate-600",children:P((null===(t=eg.find(e=>e.id===eb))||void 0===t?void 0:t.phoneNumber)||"")})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(O.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"No phone number assigned"})]})}),eZ?(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Saving..."}):(0,a.jsx)(D.Z,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 transition-transform ".concat(eC?"rotate-180":"")})]}),eC&&(0,a.jsxs)("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-md shadow-lg py-1 max-h-60 overflow-auto",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>eP(""),className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm hover:bg-slate-50 text-left",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:(0,a.jsx)(O.Z,{className:"h-4 w-4 text-muted-foreground"})}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"No phone number"})]}),eg.map(e=>{var t,s;let l=e.agent&&e.agent.id&&e.agent.id!==b.id,n=(null===(t=e.agent)||void 0===t?void 0:t.id)===b.id;return(0,a.jsxs)("button",{type:"button",onClick:()=>eP(e.id),className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm hover:bg-slate-50 text-left ".concat(n?"bg-teal-50":""),children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat(l?"bg-amber-100":"bg-teal-100"),children:(0,a.jsx)(O.Z,{className:"h-4 w-4 ".concat(l?"text-amber-600":"text-teal-600")})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"font-medium block truncate",children:P(e.phoneNumber)}),l&&(0,a.jsxs)("span",{className:"text-xs text-amber-600 block",children:["Currently assigned to: ",null===(s=e.agent)||void 0===s?void 0:s.name]}),n&&(0,a.jsx)("span",{className:"text-xs text-teal-600 block",children:"Currently assigned to this agent"})]})]},e.id)})]})]})}):(0,a.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-amber-50 border border-amber-200 rounded-md",children:[(0,a.jsx)(T.Z,{className:"h-4 w-4 text-amber-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm text-amber-800",children:"Twilio not configured"}),(0,a.jsx)("p",{className:"text-xs text-amber-700 mt-1",children:"Configure your Twilio credentials in Settings to enable phone number assignment."}),(0,a.jsxs)(i.default,{href:"/dashboard/settings",className:"inline-flex items-center gap-1 mt-2 text-xs text-teal-600 hover:underline",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3"}),"Go to Settings"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Agent Mode"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(u.jt).map(e=>{let[t,s]=e;return(0,a.jsxs)("button",{type:"button",className:"p-3 border rounded-lg text-left hover:border-teal-500 transition-colors ".concat(ee===t?"border-teal-500 bg-teal-50":""),onClick:()=>et(t),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"w-5 h-5 rounded-full flex items-center justify-center bg-teal-100",children:_(t)}),(0,a.jsx)("h3",{className:"font-semibold text-xs text-slate-600",children:s.label})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:s.description})]},t)})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"callPurpose",className:"text-sm font-medium text-muted-foreground",children:"Call Purpose"}),(0,a.jsx)(o.I,{id:"callPurpose",value:ex,onChange:e=>eu(e.target.value),placeholder:"e.g., Schedule appointments, Answer support questions"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"voice",className:"text-sm font-medium text-muted-foreground",children:"Voice"}),(0,a.jsx)(h.$,{value:K,onChange:Q})]}),("INBOUND"===ee||"HYBRID"===ee)&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"greeting",className:"text-sm font-medium text-muted-foreground",children:"Inbound Greeting (optional)"}),(0,a.jsx)(o.I,{id:"greeting",value:q,onChange:e=>J(e.target.value),placeholder:"e.g., Hi, this is ".concat((null===(s=u.Cy.find(e=>e.id===K))||void 0===s?void 0:s.name)||"your assistant",". How can I help you today?")})]}),("OUTBOUND"===ee||"HYBRID"===ee)&&(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"outboundGreeting",className:"text-sm font-medium text-muted-foreground",children:"Outbound Greeting (optional)"}),(0,a.jsx)(o.I,{id:"outboundGreeting",value:es,onChange:e=>ea(e.target.value),placeholder:"e.g., Hi, this is ".concat((null===(f=u.Cy.find(e=>e.id===K))||void 0===f?void 0:f.name)||"your assistant"," calling from ").concat((null==eh?void 0:eh.organizationName)||"[company]","...")})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Call Window (optional)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"From"}),(0,a.jsx)(o.I,{type:"time",value:el,onChange:e=>en(e.target.value),placeholder:"Start time",className:"flex-1 [&::-webkit-calendar-picker-indicator]:opacity-100 [&::-webkit-calendar-picker-indicator]:brightness-0 [&::-webkit-calendar-picker-indicator]:saturate-100 [&::-webkit-calendar-picker-indicator]:invert-[.5] [&::-webkit-calendar-picker-indicator]:sepia-[1] [&::-webkit-calendar-picker-indicator]:saturate-[10] [&::-webkit-calendar-picker-indicator]:hue-rotate-[130deg]"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"To"}),(0,a.jsx)(o.I,{type:"time",value:ei,onChange:e=>er(e.target.value),placeholder:"End time",className:"flex-1 [&::-webkit-calendar-picker-indicator]:opacity-100 [&::-webkit-calendar-picker-indicator]:brightness-0 [&::-webkit-calendar-picker-indicator]:saturate-100 [&::-webkit-calendar-picker-indicator]:invert-[.5] [&::-webkit-calendar-picker-indicator]:sepia-[1] [&::-webkit-calendar-picker-indicator]:saturate-[10] [&::-webkit-calendar-picker-indicator]:hue-rotate-[130deg]"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"systemPrompt",className:"text-sm font-medium text-muted-foreground",children:"System Prompt"}),(0,a.jsx)("textarea",{id:"systemPrompt",value:X,onChange:e=>$(e.target.value),className:"w-full min-h-[200px] px-3 py-2 border rounded-md bg-background"})]}),(null==eo?void 0:eo.connected)&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Tool Access (optional)"}),(0,a.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border cursor-pointer hover:bg-slate-50 transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:ed,onChange:e=>ec(e.target.checked),className:"mt-0.5 h-4 w-4 rounded border-gray-300 text-teal-600 focus:ring-teal-500"}),(0,a.jsx)(E.Z,{className:"h-4 w-4 text-teal-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-slate-600",children:"Calendar"}),(null==eo?void 0:eo.provider)&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-teal-100 text-teal-700",children:"calcom"===eo.provider?"Cal.com":"Calendly"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"When enabled, this agent can check your availability and book appointments"})]})]})]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-6 pb-6 border-b",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:(null===(g=u.Cy.find(e=>e.id===F.voice))||void 0===g?void 0:g.avatar)?(0,a.jsx)(r.default,{src:u.Cy.find(e=>e.id===F.voice).avatar,alt:(null===(p=u.Cy.find(e=>e.id===F.voice))||void 0===p?void 0:p.name)||"Voice",width:96,height:96,className:"w-full h-full object-cover"}):(0,a.jsx)(I.Z,{className:"w-12 h-12 text-slate-400"})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Voice"}),(0,a.jsx)("p",{className:"font-medium text-lg text-slate-600",children:(null===(j=u.Cy.find(e=>e.id===F.voice))||void 0===j?void 0:j.name)||F.voice}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:null===(N=u.Cy.find(e=>e.id===F.voice))||void 0===N?void 0:N.description}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Powered by ElevenLabs and GPT-4o"})]})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Tool Access"}),(0,a.jsxs)("div",{className:"flex items-start gap-3 mt-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4 text-teal-600 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-slate-600",children:"Calendar"}),F.calendarEnabled&&(null==eo?void 0:eo.connected)?(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-teal-100 text-teal-700",children:"calcom"===eo.provider?"Cal.com":"Calendly"}):(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-600",children:"Disabled"})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:F.calendarEnabled&&(null==eo?void 0:eo.connected)?'Using "'.concat(eo.eventTypeName,'" for appointments'):(null==eo?void 0:eo.connected)?"Calendar access not enabled for this agent":"Calendar not connected"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Organization"}),(null==eh?void 0:eh.organizationName)?(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-teal-100",children:(0,a.jsx)(Z.Z,{className:"h-3 w-3 text-teal-600"})}),(0,a.jsx)("span",{className:"font-medium text-slate-600",children:eh.organizationName})]})}):(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Not configured"}),(0,a.jsxs)(i.default,{href:"/dashboard/settings?tab=preferences",className:"inline-flex items-center gap-1 text-xs text-teal-600 hover:underline mt-1",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3"}),"Set up in Settings"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone Number"}),ew?(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Loading..."}):ej?(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-teal-100",children:(0,a.jsx)(O.Z,{className:"h-3 w-3 text-teal-600"})}),(0,a.jsx)("span",{className:"font-medium text-slate-600",children:P(ej.phoneNumber)})]})}):(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No phone number assigned"}),(0,a.jsxs)(i.default,{href:"/dashboard/settings",className:"inline-flex items-center gap-1 text-xs text-teal-600 hover:underline mt-1",children:[(0,a.jsx)(A.Z,{className:"h-3 w-3"}),"Assign in Settings"]})]})]}),F.mode&&u.jt[F.mode]&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Mode"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-teal-100",children:_(F.mode)}),(0,a.jsx)("span",{className:"font-medium text-slate-600",children:u.jt[F.mode].label})]})})]}),F.callPurpose&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Call Purpose"}),(0,a.jsx)("p",{className:"font-medium text-slate-600 mt-1",children:F.callPurpose})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Created"}),(0,a.jsx)("p",{className:"font-medium text-slate-600",children:new Date(F.createdAt).toLocaleDateString()})]}),("OUTBOUND"===F.mode||"HYBRID"===F.mode)&&F.callWindowStart&&F.callWindowEnd&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Call Window"}),(0,a.jsxs)("p",{className:"font-medium text-slate-600",children:[F.callWindowStart," - ",F.callWindowEnd]})]}),F.greeting&&(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Greeting"}),(0,a.jsx)("p",{className:"font-medium text-slate-600",children:F.greeting})]}),("OUTBOUND"===F.mode||"HYBRID"===F.mode)&&F.outboundGreeting&&(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Outbound Greeting"}),(0,a.jsx)("p",{className:"font-medium text-slate-600",children:F.outboundGreeting})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"System Prompt"}),(0,a.jsx)("p",{className:"font-medium text-slate-600 whitespace-pre-wrap bg-muted p-3 rounded-md text-sm mt-1",children:F.systemPrompt})]})]})]})})]}),H&&F&&(0,a.jsx)(v,{agentId:F.id,agentName:F.name,callWindow:F.callWindowStart&&F.callWindowEnd?{start:F.callWindowStart,end:F.callWindowEnd}:void 0,onClose:()=>L(!1),onCallInitiated:e=>{console.log("Call initiated:",e)}})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[400px] gap-4",children:[(0,a.jsx)("div",{className:"text-muted-foreground",children:"Agent not found"}),(0,a.jsx)(i.default,{href:"/dashboard/agents",children:(0,a.jsxs)(d.z,{variant:"ghost",className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"Back to Agents"]})})]})}},9173:function(e,t,s){"use strict";s.d(t,{$:function(){return c}});var a=s(7437),l=s(2265),n=s(3145),i=s(8705),r=s(2369),d=s(875);function c(e){let{value:t,onChange:s,disabled:c=!1}=e,[o,m]=(0,l.useState)(!1),x=(0,l.useRef)(null),u=i.Cy.find(e=>e.id===t)||i.Cy[0];(0,l.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&m(!1)};return o&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[o]);let h=e=>{s(e),m(!1)};return(0,a.jsxs)("div",{className:"relative",ref:x,children:[(0,a.jsxs)("button",{type:"button",onClick:()=>!c&&m(!o),disabled:c,className:"w-full flex items-center gap-3 px-3 py-2.5 border rounded-md bg-white hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:u.avatar?(0,a.jsx)(n.default,{src:u.avatar,alt:u.name,width:48,height:48,className:"w-full h-full object-cover"}):(0,a.jsx)(r.Z,{className:"w-6 h-6 text-slate-400"})}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-slate-600",children:u.name}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:u.description})]}),(0,a.jsx)(d.Z,{className:"w-4 h-4 text-slate-400 transition-transform ".concat(o?"rotate-180":"")})]}),o&&(0,a.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border rounded-md shadow-lg max-h-80 overflow-y-auto",children:i.Cy.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>h(e.id),className:"w-full flex items-center gap-3 px-3 py-2.5 hover:bg-slate-50 transition-colors ".concat(e.id===t?"bg-primary/5":""),children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:e.avatar?(0,a.jsx)(n.default,{src:e.avatar,alt:e.name,width:48,height:48,className:"w-full h-full object-cover"}):(0,a.jsx)(r.Z,{className:"w-6 h-6 text-slate-400"})}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("div",{className:"font-medium text-sm text-slate-600",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:e.description})]}),e.id===t&&(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary flex-shrink-0"})]},e.id))})]})}},279:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var a=s(7437),l=s(2265),n=s(3448);let i=l.forwardRef((e,t)=>{let{className:s,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},3340:function(e,t,s){"use strict";s.d(t,{pm:function(){return x}});var a=s(2265);let l=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),o({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},r=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],c={toasts:[]};function o(e){c=r(c,e),d.forEach(e=>{e(c)})}function m(e){let{...t}=e,s=(l=(l+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:"DISMISS_TOAST",toastId:s});return o({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>o({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function x(){let[e,t]=a.useState(c);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>o({type:"DISMISS_TOAST",toastId:e})}}}},function(e){e.O(0,[225,145,648,153,798,971,117,744],function(){return e(e.s=6679)}),_N_E=e.O()}]);